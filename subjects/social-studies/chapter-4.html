<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 4: Economics & Cultural Heritage - Social Studies</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <style>
        .economics-section {
            background: linear-gradient(135deg, #2E8B57, #32CD32);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .cultural-section {
            background: linear-gradient(135deg, #FF6347, #FF4500);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .activity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .activity-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .activity-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .economics-card {
            border-color: #2E8B57;
        }

        .cultural-card {
            border-color: #FF6347;
        }

        .economics-simulator {
            background: linear-gradient(135deg, #F0FFF0, #E0FFE0);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .cultural-explorer {
            background: linear-gradient(135deg, #FFF8DC, #FFEBCD);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .market-game {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .market-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 2px solid #2E8B57;
        }

        .market-section h4 {
            color: #2E8B57;
            margin-bottom: 10px;
        }

        .good-service-item {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 10px;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .good-service-item:hover {
            background: #e9ecef;
            transform: scale(1.02);
        }

        .good-service-item.selected {
            background: #d4edda;
            border-color: #28a745;
        }

        .cultural-timeline {
            position: relative;
            margin: 30px 0;
        }

        .timeline-item {
            display: flex;
            margin: 20px 0;
            align-items: center;
        }

        .timeline-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #FF6347;
            margin-right: 20px;
            flex-shrink: 0;
        }

        .timeline-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #FF6347;
        }

        .heritage-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .heritage-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
            border: 2px solid #FF6347;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .heritage-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.15);
        }

        .heritage-card.active {
            background: #FFF8DC;
            border-color: #FF4500;
        }

        .heritage-details {
            background: #FFF8DC;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            display: none;
        }

        .heritage-details.show {
            display: block;
        }

        .economy-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 2px solid #2E8B57;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #2E8B57;
            display: block;
        }

        .quiz-section {
            background: linear-gradient(135deg, #4169E1, #1E90FF);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .quiz-question {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }

        .quiz-option {
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 5px;
            padding: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            background: rgba(255,255,255,0.3);
        }

        .quiz-option.correct {
            background: #28a745;
        }

        .quiz-option.incorrect {
            background: #dc3545;
        }

        .achievement-section {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .achievement-badges {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .achievement-badge {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 3px solid #ddd;
            transition: all 0.3s ease;
        }

        .achievement-badge.earned {
            border-color: #FFD700;
            background: linear-gradient(135deg, #FFF, #FFFAF0);
        }

        .badge-icon {
            font-size: 3em;
            margin-bottom: 10px;
            filter: grayscale(100%);
            transition: filter 0.3s ease;
        }

        .achievement-badge.earned .badge-icon {
            filter: grayscale(0%);
        }

        .progress-summary {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #6c757d;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .progress-bar-container {
            width: 200px;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            width: 0%;
            transition: width 0.5s ease;
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 1000;
            display: none;
        }

        .celebration.show {
            display: block;
            animation: celebrationPop 0.5s ease;
        }

        @keyframes celebrationPop {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .tab-navigation {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
            margin: 20px 0 0 0;
        }

        .tab-button {
            flex: 1;
            padding: 15px;
            background: #6c757d;
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: #007bff;
        }

        .tab-button:hover:not(.active) {
            background: #5a6268;
        }

        .tab-content {
            background: white;
            border: 2px solid #007bff;
            border-top: none;
            border-radius: 0 0 10px 10px;
            padding: 20px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .market-game {
                grid-template-columns: 1fr;
            }
            
            .quiz-options {
                grid-template-columns: 1fr;
            }
            
            .heritage-cards {
                grid-template-columns: 1fr;
            }
            
            .economy-stats {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div id="header-container"></div>
    <main class="chapter-container">
        <div class="chapter-header">
            <div class="chapter-number">Chapter 4</div>
            <h1 class="chapter-title">Economics & Cultural Heritage</h1>
            <p class="chapter-subtitle">Explore Texas economics and celebrate our diverse cultural traditions</p>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" onclick="showTab('economics')">🏦 Economics</button>
            <button class="tab-button" onclick="showTab('culture')">🎭 Cultural Heritage</button>
            <button class="tab-button" onclick="showTab('activities')">🎯 Activities</button>
            <button class="tab-button" onclick="showTab('quiz')">📝 Knowledge Check</button>
        </div>

        <!-- Economics Tab -->
        <div id="economics" class="tab-content active">
            <div class="economics-section">
                <h2>💰 Economics Fundamentals</h2>
                <p>Learn how our economy works through goods, services, producers, and consumers!</p>
            </div>

            <!-- Goods vs Services Activity -->
            <div class="economics-simulator">
                <h3>🏪 Goods vs Services Sorter</h3>
                <p>Drag items to the correct category: Are they GOODS (things you can touch) or SERVICES (actions people do for you)?</p>
                
                <div class="market-game">
                    <div class="market-section">
                        <h4>Items to Sort</h4>
                        <div id="items-to-sort">
                            <div class="good-service-item" draggable="true" data-type="good" data-item="bicycle">🚲 Bicycle</div>
                            <div class="good-service-item" draggable="true" data-type="service" data-item="haircut">✂️ Haircut</div>
                            <div class="good-service-item" draggable="true" data-type="good" data-item="apple">🍎 Apple</div>
                            <div class="good-service-item" draggable="true" data-type="service" data-item="teaching">👩‍🏫 Teaching</div>
                            <div class="good-service-item" draggable="true" data-type="good" data-item="book">📚 Book</div>
                            <div class="good-service-item" draggable="true" data-type="service" data-item="delivery">🚚 Delivery</div>
                            <div class="good-service-item" draggable="true" data-type="good" data-item="computer">💻 Computer</div>
                            <div class="good-service-item" draggable="true" data-type="service" data-item="cleaning">🧽 Cleaning</div>
                        </div>
                    </div>
                    
                    <div class="market-section" id="goods-box">
                        <h4>GOODS</h4>
                        <p>Things you can touch</p>
                        <div class="drop-zone" data-category="good" style="min-height: 200px; border: 2px dashed #2E8B57; padding: 10px; border-radius: 5px;">
                            Drop goods here!
                        </div>
                    </div>
                    
                    <div class="market-section" id="services-box">
                        <h4>SERVICES</h4>
                        <p>Actions people do</p>
                        <div class="drop-zone" data-category="service" style="min-height: 200px; border: 2px dashed #2E8B57; padding: 10px; border-radius: 5px;">
                            Drop services here!
                        </div>
                    </div>
                </div>
                
                <div id="sorting-result" style="margin-top: 20px;"></div>
                <button onclick="checkSorting()" class="activity-button">Check My Sorting!</button>
            </div>

            <!-- Texas Economy Stats -->
            <div class="economy-stats">
                <div class="stat-card">
                    <span class="stat-number">2nd</span>
                    <span>Largest State Economy</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">29M</span>
                    <span>Population</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">$2.4T</span>
                    <span>Annual GDP</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">254</span>
                    <span>Counties</span>
                </div>
            </div>

            <!-- Supply and Demand Simulator -->
            <div class="economics-simulator">
                <h3>📊 Supply & Demand Game</h3>
                <p>See how supply and demand affect prices in this interactive simulation!</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <h4>🏭 Supply</h4>
                        <p>How many items are available?</p>
                        <input type="range" id="supply-slider" min="1" max="100" value="50" oninput="updateSupplyDemand()">
                        <span id="supply-value">50</span> items available
                    </div>
                    <div>
                        <h4>🛒 Demand</h4>
                        <p>How many people want the item?</p>
                        <input type="range" id="demand-slider" min="1" max="100" value="50" oninput="updateSupplyDemand()">
                        <span id="demand-value">50</span> people want it
                    </div>
                </div>
                
                <div style="text-align: center; margin: 20px 0;">
                    <h4>💰 Price: $<span id="price-display">10.00</span></h4>
                    <div id="price-explanation" style="margin-top: 10px; padding: 15px; background: #f8f9fa; border-radius: 5px;"></div>
                </div>
            </div>
        </div>

        <!-- Cultural Heritage Tab -->
        <div id="culture" class="tab-content">
            <div class="cultural-section">
                <h2>🎭 Texas Cultural Heritage</h2>
                <p>Discover the rich cultural diversity that makes Texas special!</p>
            </div>

            <!-- Cultural Groups Explorer -->
            <div class="cultural-explorer">
                <h3>🌎 Cultural Groups in Texas</h3>
                <p>Click on each cultural group to learn about their contributions to Texas!</p>
                
                <div class="heritage-cards">
                    <div class="heritage-card" onclick="showCulture('native')">
                        <h4>🏛️ Native American</h4>
                        <p>First peoples of Texas</p>
                    </div>
                    <div class="heritage-card" onclick="showCulture('hispanic')">
                        <h4>🇲🇽 Hispanic/Latino</h4>
                        <p>Spanish & Mexican heritage</p>
                    </div>
                    <div class="heritage-card" onclick="showCulture('african')">
                        <h4>🌍 African American</h4>
                        <p>Rich traditions & contributions</p>
                    </div>
                    <div class="heritage-card" onclick="showCulture('european')">
                        <h4>🇪🇺 European</h4>
                        <p>German, Irish & other settlers</p>
                    </div>
                    <div class="heritage-card" onclick="showCulture('asian')">
                        <h4>🇦🇸 Asian American</h4>
                        <p>Diverse Asian communities</p>
                    </div>
                    <div class="heritage-card" onclick="showCulture('modern')">
                        <h4>🌟 Modern Immigrants</h4>
                        <p>New Americans from worldwide</p>
                    </div>
                </div>
                
                <div id="culture-details" class="heritage-details">
                    <h4 id="culture-title">Select a cultural group above!</h4>
                    <div id="culture-content">
                        <p>Click on any cultural group card above to learn about their unique contributions to Texas culture!</p>
                    </div>
                </div>
            </div>

            <!-- Cultural Timeline -->
            <div class="cultural-explorer">
                <h3>📅 Texas Cultural Timeline</h3>
                <div class="cultural-timeline">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4>Pre-1500s: Native American Civilizations</h4>
                            <p>Caddo, Comanche, Apache, and other tribes established rich cultures across Texas with unique traditions, languages, and ways of life.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4>1519-1821: Spanish Colonial Period</h4>
                            <p>Spanish explorers and settlers brought language, religion, architecture, and cultural traditions that still influence Texas today.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4>1821-1836: Mexican Texas</h4>
                            <p>Mexican culture, including food, music, and festivals, became deeply rooted in Texas communities.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4>1836-1845: Republic of Texas</h4>
                            <p>Anglo-American settlers brought new traditions while blending with existing cultures to create unique Texas identity.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4>1800s-1900s: Immigration Waves</h4>
                            <p>Germans, Czechs, Poles, and other Europeans established communities with distinct cultural celebrations and traditions.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4>Modern Era: Diverse Communities</h4>
                            <p>Continued immigration from Asia, Africa, and Latin America creates Texas's current multicultural landscape.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Activities Tab -->
        <div id="activities" class="tab-content">
            <div class="activity-grid">
                <div class="activity-card economics-card">
                    <h3>🏪 Virtual Market</h3>
                    <p>Run your own business and learn about profit, costs, and customers!</p>
                    <button onclick="startMarketGame()" class="activity-button">Start Business</button>
                    <div id="market-game-area" style="display: none; margin-top: 15px;">
                        <h4>🎯 Your Lemonade Stand</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
                            <div>
                                <label>Cup Price: $</label>
                                <input type="number" id="cup-price" value="1" min="0.5" max="5" step="0.25" oninput="calculateProfit()">
                            </div>
                            <div>
                                <label>Cups to Make:</label>
                                <input type="number" id="cups-to-make" value="20" min="5" max="100" step="5" oninput="calculateProfit()">
                            </div>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                            <p><strong>Cost to make each cup:</strong> $0.25 (lemons, sugar, water)</p>
                            <p><strong>Total Cost:</strong> $<span id="total-cost">5.00</span></p>
                            <p><strong>Expected Revenue:</strong> $<span id="total-revenue">20.00</span></p>
                            <p><strong>Expected Profit:</strong> $<span id="profit">15.00</span></p>
                        </div>
                        <button onclick="sellLemonade()" class="activity-button">Start Selling!</button>
                        <div id="sales-result" style="margin-top: 15px;"></div>
                    </div>
                </div>

                <div class="activity-card cultural-card">
                    <h3>🎉 Festival Planner</h3>
                    <p>Plan a multicultural festival celebrating Texas diversity!</p>
                    <button onclick="startFestivalPlanner()" class="activity-button">Plan Festival</button>
                    <div id="festival-planner" style="display: none; margin-top: 15px;">
                        <h4>🎪 Texas Unity Festival</h4>
                        <div style="margin: 15px 0;">
                            <h5>Choose Cultural Activities:</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <label><input type="checkbox" value="mariachi"> 🎵 Mariachi Music</label>
                                <label><input type="checkbox" value="bbq"> 🍖 Texas BBQ</label>
                                <label><input type="checkbox" value="pow-wow"> 🪶 Native American Pow-Wow</label>
                                <label><input type="checkbox" value="polka"> 🎺 German Polka</label>
                                <label><input type="checkbox" value="dragon"> 🐉 Asian Dragon Dance</label>
                                <label><input type="checkbox" value="blues"> 🎷 Blues Music</label>
                                <label><input type="checkbox" value="folk"> 💃 Folk Dancing</label>
                                <label><input type="checkbox" value="art"> 🎨 Cultural Art Displays</label>
                            </div>
                        </div>
                        <button onclick="createFestival()" class="activity-button">Create My Festival!</button>
                        <div id="festival-result" style="margin-top: 15px;"></div>
                    </div>
                </div>

                <div class="activity-card economics-card">
                    <h3>💼 Career Explorer</h3>
                    <p>Explore different jobs and careers in the Texas economy!</p>
                    <button onclick="exploreCareer()" class="activity-button">Explore Careers</button>
                    <div id="career-explorer" style="display: none; margin-top: 15px;"></div>
                </div>

                <div class="activity-card cultural-card">
                    <h3>🏛️ Heritage Museum</h3>
                    <p>Create exhibits showcasing Texas cultural heritage!</p>
                    <button onclick="createMuseum()" class="activity-button">Build Museum</button>
                    <div id="museum-builder" style="display: none; margin-top: 15px;"></div>
                </div>
            </div>
        </div>

        <!-- Quiz Tab -->
        <div id="quiz" class="tab-content">
            <div class="quiz-section">
                <h2>📝 Economics & Cultural Heritage Quiz</h2>
                <p>Test your knowledge about Texas economics and cultural heritage!</p>
                
                <div id="quiz-container">
                    <div class="quiz-question">
                        <h4>Question 1 of 10</h4>
                        <p id="current-question">What is the difference between goods and services?</p>
                        <div class="quiz-options">
                            <button class="quiz-option" onclick="selectAnswer(this, false)">Goods are expensive, services are cheap</button>
                            <button class="quiz-option" onclick="selectAnswer(this, true)">Goods are things you can touch, services are actions</button>
                            <button class="quiz-option" onclick="selectAnswer(this, false)">Goods are new, services are old</button>
                            <button class="quiz-option" onclick="selectAnswer(this, false)">There is no difference</button>
                        </div>
                        <div id="answer-explanation" style="display: none; margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 5px;"></div>
                    </div>
                    <button id="next-question-btn" onclick="nextQuestion()" style="display: none; margin-top: 15px;">Next Question</button>
                </div>
                
                <div id="quiz-results" style="display: none; text-align: center; margin-top: 20px;">
                    <h3>🎉 Quiz Complete!</h3>
                    <p>Your Score: <span id="final-score">0</span>/10</p>
                    <div id="score-message"></div>
                    <button onclick="restartQuiz()" class="activity-button">Take Quiz Again</button>
                </div>
            </div>
        </div>

        <!-- Achievement Section -->
        <div class="achievement-section">
            <h2>🏆 Chapter 4 Achievements</h2>
            <div class="achievement-badges">
                <div class="achievement-badge" id="economics-badge">
                    <div class="badge-icon">💰</div>
                    <h4>Economics Expert</h4>
                    <p>Master goods, services, and supply & demand</p>
                </div>
                <div class="achievement-badge" id="culture-badge">
                    <div class="badge-icon">🎭</div>
                    <h4>Culture Curator</h4>
                    <p>Explore all cultural groups in Texas</p>
                </div>
                <div class="achievement-badge" id="activity-badge">
                    <div class="badge-icon">🎯</div>
                    <h4>Activity Master</h4>
                    <p>Complete all interactive activities</p>
                </div>
                <div class="achievement-badge" id="quiz-badge">
                    <div class="badge-icon">🎓</div>
                    <h4>Knowledge Champion</h4>
                    <p>Score 80% or higher on the quiz</p>
                </div>
            </div>
        </div>

        <!-- Progress Summary -->
        <div class="progress-summary">
            <h3>📊 Chapter 4 Progress</h3>
            <div class="progress-item">
                <span>Economics Learning:</span>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="economics-progress"></div>
                </div>
                <span id="economics-percent">0%</span>
            </div>
            <div class="progress-item">
                <span>Cultural Exploration:</span>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="culture-progress"></div>
                </div>
                <span id="culture-percent">0%</span>
            </div>
            <div class="progress-item">
                <span>Activities Completed:</span>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="activities-progress"></div>
                </div>
                <span id="activities-percent">0%</span>
            </div>
            <div class="progress-item">
                <span>Overall Progress:</span>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="overall-progress"></div>
                </div>
                <span id="overall-percent">0%</span>
            </div>
        </div>

        <!-- Navigation -->
        <div class="chapter-navigation">
            <a href="chapter-3.html" class="nav-button">← Chapter 3: Government</a>
            <div class="progress-indicator">
                <div class="progress-bar"><div class="progress-fill" id="main-progress" style="width: 0%"></div></div>
            </div>
            <a href="assessment-1.html" class="nav-button">Assessment →</a>
        </div>
    </main>

    <!-- Celebration Modal -->
    <div id="celebration-modal" class="celebration">
        <h2>🎉 Congratulations!</h2>
        <p id="celebration-message">You've achieved something great!</p>
        <button onclick="closeCelebration()" class="activity-button">Continue Learning</button>
    </div>

    <div id="footer-container"></div>

    <script>
        // Load shared components
        function loadSharedComponents() {
            fetch('/subjects/shared/header.html').then(r => r.text()).then(h => document.getElementById('header-container').innerHTML = h);
            fetch('/subjects/shared/footer.html').then(r => r.text()).then(h => document.getElementById('footer-container').innerHTML = h);
        }
        document.readyState === 'loading' ? document.addEventListener('DOMContentLoaded', loadSharedComponents) : loadSharedComponents();

        // Progress tracking
        let chapterProgress = {
            economicsLearning: 0,
            culturalExploration: 0,
            activitiesCompleted: 0,
            quizCompleted: false,
            badgesEarned: 0
        };

        // Cultural group data
        const culturalGroups = {
            native: {
                title: "🏛️ Native American Heritage",
                content: `
                    <h5>First Peoples of Texas</h5>
                    <p><strong>Major Tribes:</strong> Caddo, Comanche, Apache, Cherokee, Tonkawa, Karankawa</p>
                    <p><strong>Contributions:</strong></p>
                    <ul>
                        <li>🌽 Agricultural knowledge (corn, beans, squash)</li>
                        <li>🏹 Hunting and fishing techniques</li>
                        <li>🛤️ Trail systems that became major roads</li>
                        <li>🎨 Art, pottery, and basketry traditions</li>
                        <li>🌿 Knowledge of native plants and medicines</li>
                    </ul>
                    <p><strong>Modern Legacy:</strong> Place names, cultural centers, and ongoing tribal nations in Texas today.</p>
                `
            },
            hispanic: {
                title: "🇲🇽 Hispanic/Latino Heritage", 
                content: `
                    <h5>Spanish & Mexican Foundations</h5>
                    <p><strong>Origins:</strong> Spanish colonists (1519), Mexican period (1821-1836), ongoing immigration</p>
                    <p><strong>Contributions:</strong></p>
                    <ul>
                        <li>🏘️ Cities: San Antonio, El Paso, Laredo, Corpus Christi</li>
                        <li>🌮 Cuisine: Tex-Mex food, barbacoa, tamales</li>
                        <li>🎵 Music: Mariachi, conjunto, Tejano</li>
                        <li>🏛️ Architecture: Spanish colonial, mission style</li>
                        <li>🎉 Celebrations: Cinco de Mayo, Día de los Muertos, Fiesta</li>
                    </ul>
                    <p><strong>Modern Impact:</strong> Largest cultural group in Texas, shaping language, politics, and culture.</p>
                `
            },
            african: {
                title: "🌍 African American Heritage",
                content: `
                    <h5>Resilience & Cultural Richness</h5>
                    <p><strong>History:</strong> Enslaved peoples (1800s), Reconstruction, Great Migration, Civil Rights</p>
                    <p><strong>Contributions:</strong></p>
                    <ul>
                        <li>🎵 Music: Blues, gospel, country, hip-hop</li>
                        <li>🍗 Cuisine: Soul food, barbecue traditions</li>
                        <li>📚 Literature: Storytelling, poetry, novels</li>
                        <li>⚖️ Civil Rights: Leadership in equality movements</li>
                        <li>🏀 Sports & Entertainment: Athletes, performers, artists</li>
                    </ul>
                    <p><strong>Cultural Centers:</strong> Houston's Third Ward, Dallas's Deep Ellum, historic Freedmen's Towns.</p>
                `
            },
            european: {
                title: "🇪🇺 European Heritage",
                content: `
                    <h5>Diverse European Settlers</h5>
                    <p><strong>Major Groups:</strong> German, Irish, Polish, Czech, Italian immigrants (1800s-1900s)</p>
                    <p><strong>Contributions:</strong></p>
                    <ul>
                        <li>🏘️ Towns: Fredericksburg (German), West (Czech)</li>
                        <li>🎺 Music: Polka, folk music traditions</li>
                        <li>🍺 Food: Sausages, beer brewing, pastries</li>
                        <li>🏗️ Architecture: European building styles</li>
                        <li>🎪 Festivals: Oktoberfest, Polish festivals</li>
                    </ul>
                    <p><strong>Legacy:</strong> Small-town culture, agricultural techniques, and cultural festivals across Texas.</p>
                `
            },
            asian: {
                title: "🇦🇸 Asian American Heritage",
                content: `
                    <h5>Growing Asian Communities</h5>
                    <p><strong>Origins:</strong> Chinese (1800s railroads), Japanese, Vietnamese, Indian, Korean, Filipino immigration</p>
                    <p><strong>Contributions:</strong></p>
                    <ul>
                        <li>🍜 Cuisine: Chinese, Vietnamese, Indian, Korean restaurants</li>
                        <li>💼 Business: Entrepreneurship, technology, healthcare</li>
                        <li>🎓 Education: Academic excellence, teaching</li>
                        <li>🎨 Arts: Traditional crafts, martial arts, music</li>
                        <li>🏥 Healthcare: Medical professionals, alternative medicine</li>
                    </ul>
                    <p><strong>Modern Communities:</strong> Houston's Chinatown, Little Saigon, diverse suburban communities.</p>
                `
            },
            modern: {
                title: "🌟 Modern Immigrant Communities",
                content: `
                    <h5>New Americans from Around the World</h5>
                    <p><strong>Recent Arrivals:</strong> Middle Eastern, African, South American, and other global communities</p>
                    <p><strong>Contributions:</strong></p>
                    <ul>
                        <li>🌮 Food: Fusion cuisines, international markets</li>
                        <li>🏢 Business: Startups, international trade</li>
                        <li>🎭 Arts: Contemporary music, art, literature</li>
                        <li>💻 Technology: Innovation, engineering</li>
                        <li>🤝 Community: Cultural exchange, volunteer work</li>
                    </ul>
                    <p><strong>Impact:</strong> Continuing Texas's tradition as a welcoming place for people seeking opportunity.</p>
                `
            }
        };

        // Quiz questions and answers
        const quizQuestions = [
            {
                question: "What is the difference between goods and services?",
                options: [
                    "Goods are expensive, services are cheap",
                    "Goods are things you can touch, services are actions",
                    "Goods are new, services are old", 
                    "There is no difference"
                ],
                correct: 1,
                explanation: "Goods are physical items you can touch (like books, food, clothes). Services are actions people do for you (like teaching, cleaning, haircuts)."
            },
            {
                question: "What happens to price when demand is high but supply is low?",
                options: [
                    "Price goes down",
                    "Price stays the same",
                    "Price goes up",
                    "Price disappears"
                ],
                correct: 2,
                explanation: "When many people want something (high demand) but there isn't much available (low supply), the price goes up because people will pay more to get it."
            },
            {
                question: "Which cultural group was in Texas first?",
                options: [
                    "Spanish settlers",
                    "Native Americans",
                    "Mexican ranchers",
                    "European immigrants"
                ],
                correct: 1,
                explanation: "Native American tribes like the Caddo, Comanche, and Apache lived in Texas for thousands of years before any other groups arrived."
            },
            {
                question: "What is Texas's rank in the U.S. economy?",
                options: [
                    "1st largest",
                    "2nd largest",
                    "3rd largest",
                    "5th largest"
                ],
                correct: 1,
                explanation: "Texas has the 2nd largest state economy in the United States, after California."
            },
            {
                question: "Which food tradition came from Hispanic/Latino culture in Texas?",
                options: [
                    "Hamburgers",
                    "Pizza",
                    "Tex-Mex cuisine",
                    "Hot dogs"
                ],
                correct: 2,
                explanation: "Tex-Mex cuisine, including tacos, enchiladas, and tamales, comes from the blend of Mexican and Texas cultures."
            },
            {
                question: "In business, what is profit?",
                options: [
                    "The money you spend",
                    "The money you earn minus costs",
                    "The number of customers",
                    "The price of your product"
                ],
                correct: 1,
                explanation: "Profit is how much money you have left after you subtract all your costs from the money you earned selling your products or services."
            },
            {
                question: "Which European group is known for founding Fredericksburg, Texas?",
                options: [
                    "Irish immigrants",
                    "German immigrants", 
                    "Italian immigrants",
                    "Polish immigrants"
                ],
                correct: 1,
                explanation: "German immigrants founded Fredericksburg in 1846 and brought their culture, including Oktoberfest celebrations and German architecture."
            },
            {
                question: "What does a producer do in the economy?",
                options: [
                    "Buys goods and services",
                    "Makes or creates goods and services",
                    "Uses products",
                    "Spends money"
                ],
                correct: 1,
                explanation: "A producer makes or creates goods and services that other people want to buy. Farmers, factory workers, and business owners are all producers."
            },
            {
                question: "Which cultural tradition involves mariachi music?",
                options: [
                    "Native American",
                    "German",
                    "Hispanic/Latino",
                    "African American"
                ],
                correct: 2,
                explanation: "Mariachi music is a traditional Mexican musical style that is part of Hispanic/Latino culture in Texas."
            },
            {
                question: "What makes Texas culture unique?",
                options: [
                    "Only one cultural group lives there",
                    "Many different cultural groups blend together",
                    "No cultural traditions exist",
                    "Only new traditions are allowed"
                ],
                correct: 1,
                explanation: "Texas culture is unique because many different cultural groups have contributed their traditions, creating a rich blend of languages, foods, music, and celebrations."
            }
        ];

        let currentQuizQuestion = 0;
        let quizScore = 0;
        let quizCompleted = false;

        // Tab functionality
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Update progress
            updateProgress();
        }

        // Drag and drop functionality for goods/services
        document.addEventListener('DOMContentLoaded', function() {
            const items = document.querySelectorAll('.good-service-item');
            const dropZones = document.querySelectorAll('.drop-zone');
            
            items.forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('drop', handleDrop);
            });
        });

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.item);
            e.dataTransfer.setData('text/type', e.target.dataset.type);
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDrop(e) {
            e.preventDefault();
            const item = e.dataTransfer.getData('text/plain');
            const itemType = e.dataTransfer.getData('text/type');
            const category = e.currentTarget.dataset.category;
            
            // Find the dragged element
            const draggedElement = document.querySelector(`[data-item="${item}"]`);
            
            if (draggedElement) {
                // Add to drop zone
                e.currentTarget.appendChild(draggedElement);
                
                // Add visual feedback
                if (itemType === category) {
                    draggedElement.style.backgroundColor = '#d4edda';
                    draggedElement.style.borderColor = '#28a745';
                } else {
                    draggedElement.style.backgroundColor = '#f8d7da';
                    draggedElement.style.borderColor = '#dc3545';
                }
            }
        }

        function checkSorting() {
            const goodsBox = document.querySelector('[data-category="good"]');
            const servicesBox = document.querySelector('[data-category="service"]');
            const resultDiv = document.getElementById('sorting-result');
            
            let correctCount = 0;
            let totalCount = 0;
            
            // Check goods box
            goodsBox.querySelectorAll('.good-service-item').forEach(item => {
                totalCount++;
                if (item.dataset.type === 'good') {
                    correctCount++;
                    item.style.backgroundColor = '#d4edda';
                    item.style.borderColor = '#28a745';
                } else {
                    item.style.backgroundColor = '#f8d7da';
                    item.style.borderColor = '#dc3545';
                }
            });
            
            // Check services box
            servicesBox.querySelectorAll('.good-service-item').forEach(item => {
                totalCount++;
                if (item.dataset.type === 'service') {
                    correctCount++;
                    item.style.backgroundColor = '#d4edda';
                    item.style.borderColor = '#28a745';
                } else {
                    item.style.backgroundColor = '#f8d7da';
                    item.style.borderColor = '#dc3545';
                }
            });
            
            const percentage = Math.round((correctCount / totalCount) * 100);
            
            resultDiv.innerHTML = `
                <div style="text-align: center; padding: 20px; background: white; border-radius: 10px; border: 3px solid ${percentage >= 80 ? '#28a745' : '#ffc107'};">
                    <h4>${percentage >= 80 ? '🎉 Great Job!' : '📝 Keep Learning!'}</h4>
                    <p>You got ${correctCount} out of ${totalCount} correct (${percentage}%)</p>
                    <p>${percentage >= 80 ? 'You understand the difference between goods and services!' : 'Remember: Goods are things you can touch, services are actions people do.'}</p>
                </div>
            `;
            
            if (percentage >= 80) {
                chapterProgress.economicsLearning = Math.max(chapterProgress.economicsLearning, 25);
                updateProgress();
                checkForBadges();
            }
        }

        // Supply and demand simulator
        function updateSupplyDemand() {
            const supply = parseInt(document.getElementById('supply-slider').value);
            const demand = parseInt(document.getElementById('demand-slider').value);
            
            document.getElementById('supply-value').textContent = supply;
            document.getElementById('demand-value').textContent = demand;
            
            // Calculate price based on supply and demand
            let basePrice = 10;
            let priceMultiplier = demand / supply;
            let finalPrice = basePrice * priceMultiplier;
            
            // Keep price reasonable
            finalPrice = Math.max(1, Math.min(50, finalPrice));
            
            document.getElementById('price-display').textContent = finalPrice.toFixed(2);
            
            // Explanation
            let explanation = "";
            if (demand > supply * 1.5) {
                explanation = "🔥 High demand, low supply = Higher prices! People will pay more when items are scarce.";
            } else if (supply > demand * 1.5) {
                explanation = "📉 Low demand, high supply = Lower prices! Sellers reduce prices to attract buyers.";
            } else {
                explanation = "⚖️ Balanced supply and demand = Stable prices! This is the sweet spot for fair pricing.";
            }
            
            document.getElementById('price-explanation').textContent = explanation;
            
            // Update progress
            chapterProgress.economicsLearning = Math.max(chapterProgress.economicsLearning, 50);
            updateProgress();
        }

        // Cultural group exploration
        function showCulture(groupKey) {
            // Remove active class from all cards
            document.querySelectorAll('.heritage-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active class to clicked card
            event.target.classList.add('active');
            
            // Show details
            const details = document.getElementById('culture-details');
            const group = culturalGroups[groupKey];
            
            document.getElementById('culture-title').textContent = group.title;
            document.getElementById('culture-content').innerHTML = group.content;
            
            details.classList.add('show');
            
            // Update progress
            chapterProgress.culturalExploration += 15;
            if (chapterProgress.culturalExploration > 90) chapterProgress.culturalExploration = 90;
            updateProgress();
            checkForBadges();
        }

        // Activity functions
        function startMarketGame() {
            document.getElementById('market-game-area').style.display = 'block';
            calculateProfit();
        }

        function calculateProfit() {
            const cupPrice = parseFloat(document.getElementById('cup-price').value);
            const cupsToMake = parseInt(document.getElementById('cups-to-make').value);
            const costPerCup = 0.25;
            
            const totalCost = cupsToMake * costPerCup;
            const totalRevenue = cupsToMake * cupPrice;
            const profit = totalRevenue - totalCost;
            
            document.getElementById('total-cost').textContent = totalCost.toFixed(2);
            document.getElementById('total-revenue').textContent = totalRevenue.toFixed(2);
            document.getElementById('profit').textContent = profit.toFixed(2);
        }

        function sellLemonade() {
            const cupPrice = parseFloat(document.getElementById('cup-price').value);
            const cupsToMake = parseInt(document.getElementById('cups-to-make').value);
            
            // Simple demand simulation
            let maxCustomers = Math.floor(100 / cupPrice); // Lower price = more customers
            let actualCustomers = Math.min(cupsToMake, Math.floor(Math.random() * maxCustomers) + 5);
            
            const revenue = actualCustomers * cupPrice;
            const cost = cupsToMake * 0.25;
            const profit = revenue - cost;
            
            document.getElementById('sales-result').innerHTML = `
                <div style="background: white; padding: 15px; border-radius: 10px; border: 3px solid #28a745;">
                    <h5>🎉 Sales Results!</h5>
                    <p><strong>Customers served:</strong> ${actualCustomers}</p>
                    <p><strong>Revenue earned:</strong> $${revenue.toFixed(2)}</p>
                    <p><strong>Total cost:</strong> $${cost.toFixed(2)}</p>
                    <p><strong>Your profit:</strong> $${profit.toFixed(2)}</p>
                    <p>${profit > 0 ? '💰 Congratulations! You made a profit!' : '📚 You learned about business - try adjusting your price!'}</p>
                </div>
            `;
            
            chapterProgress.activitiesCompleted += 25;
            updateProgress();
            checkForBadges();
        }

        function startFestivalPlanner() {
            document.getElementById('festival-planner').style.display = 'block';
        }

        function createFestival() {
            const checkboxes = document.querySelectorAll('#festival-planner input[type="checkbox"]:checked');
            const selectedActivities = Array.from(checkboxes).map(cb => cb.value);
            
            if (selectedActivities.length === 0) {
                document.getElementById('festival-result').innerHTML = `
                    <div style="background: #fff3cd; padding: 15px; border-radius: 5px; border: 1px solid #ffeaa7;">
                        <p>Please select at least one cultural activity for your festival!</p>
                    </div>
                `;
                return;
            }
            
            const activityNames = {
                'mariachi': 'Mariachi Music Stage',
                'bbq': 'Texas BBQ Food Court',
                'pow-wow': 'Native American Pow-Wow Circle',
                'polka': 'German Polka Dance Floor',
                'dragon': 'Asian Dragon Dance Performance',
                'blues': 'Blues Music Venue',
                'folk': 'International Folk Dancing',
                'art': 'Multicultural Art Gallery'
            };
            
            document.getElementById('festival-result').innerHTML = `
                <div style="background: white; padding: 20px; border-radius: 10px; border: 3px solid #FF6347;">
                    <h5>🎪 Your Texas Unity Festival!</h5>
                    <p><strong>Featured Activities:</strong></p>
                    <ul>
                        ${selectedActivities.map(activity => `<li>${activityNames[activity]}</li>`).join('')}
                    </ul>
                    <p>🎉 What a wonderful celebration of Texas diversity! Your festival brings together ${selectedActivities.length} different cultural traditions!</p>
                </div>
            `;
            
            chapterProgress.activitiesCompleted += 25;
            chapterProgress.culturalExploration = 100;
            updateProgress();
            checkForBadges();
        }

        function exploreCareer() {
            const careers = [
                {title: "👨‍🌾 Farmer", desc: "Produce food and crops for Texas families"},
                {title: "👨‍💼 Business Owner", desc: "Start and run companies that create jobs"},
                {title: "👩‍🏫 Teacher", desc: "Educate students and share knowledge"},
                {title: "👨‍⚕️ Doctor", desc: "Keep people healthy and treat illnesses"},
                {title: "👷‍♀️ Construction Worker", desc: "Build homes, schools, and roads"},
                {title: "👨‍💻 Software Developer", desc: "Create apps and computer programs"},
                {title: "🎨 Artist", desc: "Create beautiful art and cultural expressions"},
                {title: "🚒 Firefighter", desc: "Keep communities safe from fires and emergencies"}
            ];
            
            const randomCareer = careers[Math.floor(Math.random() * careers.length)];
            
            document.getElementById('career-explorer').innerHTML = `
                <div style="background: white; padding: 20px; border-radius: 10px; border: 3px solid #2E8B57;">
                    <h5>💼 Career Spotlight: ${randomCareer.title}</h5>
                    <p><strong>What they do:</strong> ${randomCareer.desc}</p>
                    <p><strong>Economics Role:</strong> They are a <em>producer</em> in our economy, creating goods or services that people need!</p>
                    <button onclick="exploreCareer()" class="activity-button" style="margin-top: 10px;">Explore Another Career</button>
                </div>
            `;
            document.getElementById('career-explorer').style.display = 'block';
            
            chapterProgress.activitiesCompleted += 10;
            updateProgress();
        }

        function createMuseum() {
            const exhibits = [
                "🏛️ Native American Artifacts Hall",
                "🇲🇽 Hispanic Heritage Gallery", 
                "🎵 African American Music Exhibit",
                "🇩🇪 European Immigrant Stories",
                "🌏 Modern Texas Communities",
                "🎭 Cultural Celebrations Theater"
            ];
            
            document.getElementById('museum-builder').innerHTML = `
                <div style="background: white; padding: 20px; border-radius: 10px; border: 3px solid #FF6347;">
                    <h5>🏛️ Texas Heritage Museum</h5>
                    <p><strong>Your Museum Features:</strong></p>
                    <ul>
                        ${exhibits.map(exhibit => `<li>${exhibit}</li>`).join('')}
                    </ul>
                    <p>🎖️ Congratulations! You've created a museum that honors all the cultural groups that make Texas special!</p>
                </div>
            `;
            document.getElementById('museum-builder').style.display = 'block';
            
            chapterProgress.activitiesCompleted += 40;
            updateProgress();
            checkForBadges();
        }

        // Quiz functionality
        function selectAnswer(button, isCorrect) {
            // Disable all options
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.disabled = true;
            });
            
            // Show correct/incorrect
            button.classList.add(isCorrect ? 'correct' : 'incorrect');
            if (!isCorrect) {
                // Show the correct answer
                document.querySelectorAll('.quiz-option').forEach((option, index) => {
                    if (index === quizQuestions[currentQuizQuestion].correct) {
                        option.classList.add('correct');
                    }
                });
            }
            
            // Update score
            if (isCorrect) {
                quizScore++;
            }
            
            // Show explanation
            const explanation = document.getElementById('answer-explanation');
            explanation.innerHTML = `<strong>Explanation:</strong> ${quizQuestions[currentQuizQuestion].explanation}`;
            explanation.style.display = 'block';
            
            // Show next button
            document.getElementById('next-question-btn').style.display = 'inline-block';
        }

        function nextQuestion() {
            currentQuizQuestion++;
            
            if (currentQuizQuestion >= quizQuestions.length) {
                showQuizResults();
            } else {
                displayQuestion();
            }
        }

        function displayQuestion() {
            const question = quizQuestions[currentQuizQuestion];
            
            document.querySelector('.quiz-question h4').textContent = `Question ${currentQuizQuestion + 1} of ${quizQuestions.length}`;
            document.getElementById('current-question').textContent = question.question;
            
            const options = document.querySelectorAll('.quiz-option');
            options.forEach((option, index) => {
                option.textContent = question.options[index];
                option.disabled = false;
                option.classList.remove('correct', 'incorrect');
                option.onclick = () => selectAnswer(option, index === question.correct);
            });
            
            document.getElementById('answer-explanation').style.display = 'none';
            document.getElementById('next-question-btn').style.display = 'none';
        }

        function showQuizResults() {
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('quiz-results').style.display = 'block';
            
            const percentage = Math.round((quizScore / quizQuestions.length) * 100);
            document.getElementById('final-score').textContent = quizScore;
            
            let message = "";
            if (percentage >= 90) {
                message = "🏆 Outstanding! You're an Economics & Cultural Heritage expert!";
            } else if (percentage >= 80) {
                message = "🎉 Great job! You have a solid understanding of the topics!";
            } else if (percentage >= 70) {
                message = "👍 Good work! Review the material and try again for an even better score!";
            } else {
                message = "📚 Keep learning! Go back through the chapters and try the quiz again!";
            }
            
            document.getElementById('score-message').innerHTML = `<p>${message}</p>`;
            
            if (percentage >= 80) {
                chapterProgress.quizCompleted = true;
                updateProgress();
                checkForBadges();
                showCelebration("Quiz Master!", "You scored 80% or higher on the quiz!");
            }
        }

        function restartQuiz() {
            currentQuizQuestion = 0;
            quizScore = 0;
            
            document.getElementById('quiz-container').style.display = 'block';
            document.getElementById('quiz-results').style.display = 'none';
            
            displayQuestion();
        }

        // Progress and badge functions
        function updateProgress() {
            // Calculate overall progress
            let overallProgress = 0;
            overallProgress += chapterProgress.economicsLearning * 0.3;
            overallProgress += chapterProgress.culturalExploration * 0.3;
            overallProgress += Math.min(chapterProgress.activitiesCompleted, 100) * 0.25;
            overallProgress += (chapterProgress.quizCompleted ? 100 : 0) * 0.15;
            
            // Update progress bars
            document.getElementById('economics-progress').style.width = chapterProgress.economicsLearning + '%';
            document.getElementById('economics-percent').textContent = Math.round(chapterProgress.economicsLearning) + '%';
            
            document.getElementById('culture-progress').style.width = chapterProgress.culturalExploration + '%';
            document.getElementById('culture-percent').textContent = Math.round(chapterProgress.culturalExploration) + '%';
            
            const activitiesPercent = Math.min(chapterProgress.activitiesCompleted, 100);
            document.getElementById('activities-progress').style.width = activitiesPercent + '%';
            document.getElementById('activities-percent').textContent = Math.round(activitiesPercent) + '%';
            
            document.getElementById('overall-progress').style.width = overallProgress + '%';
            document.getElementById('overall-percent').textContent = Math.round(overallProgress) + '%';
            
            // Update main progress bar
            document.getElementById('main-progress').style.width = overallProgress + '%';
        }

        function checkForBadges() {
            let newBadgeEarned = false;
            
            // Economics Expert Badge
            if (chapterProgress.economicsLearning >= 75 && !document.getElementById('economics-badge').classList.contains('earned')) {
                document.getElementById('economics-badge').classList.add('earned');
                chapterProgress.badgesEarned++;
                newBadgeEarned = true;
                showCelebration("Economics Expert!", "You've mastered goods, services, and supply & demand!");
            }
            
            // Culture Curator Badge
            if (chapterProgress.culturalExploration >= 90 && !document.getElementById('culture-badge').classList.contains('earned')) {
                document.getElementById('culture-badge').classList.add('earned');
                chapterProgress.badgesEarned++;
                newBadgeEarned = true;
                showCelebration("Culture Curator!", "You've explored all cultural groups in Texas!");
            }
            
            // Activity Master Badge
            if (chapterProgress.activitiesCompleted >= 80 && !document.getElementById('activity-badge').classList.contains('earned')) {
                document.getElementById('activity-badge').classList.add('earned');
                chapterProgress.badgesEarned++;
                newBadgeEarned = true;
                showCelebration("Activity Master!", "You've completed all the interactive activities!");
            }
            
            // Quiz Champion Badge
            if (chapterProgress.quizCompleted && !document.getElementById('quiz-badge').classList.contains('earned')) {
                document.getElementById('quiz-badge').classList.add('earned');
                chapterProgress.badgesEarned++;
                newBadgeEarned = true;
                showCelebration("Knowledge Champion!", "You scored 80% or higher on the quiz!");
            }
        }

        function showCelebration(title, message) {
            document.getElementById('celebration-modal').querySelector('h2').textContent = "🎉 " + title;
            document.getElementById('celebration-message').textContent = message;
            document.getElementById('celebration-modal').classList.add('show');
        }

        function closeCelebration() {
            document.getElementById('celebration-modal').classList.remove('show');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            displayQuestion();
            updateSupplyDemand();
            updateProgress();
        });
    </script>
</body>
</html>
