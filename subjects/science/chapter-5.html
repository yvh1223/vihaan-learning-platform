<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scientific Investigation - 5th Grade Science</title>
    <link rel="stylesheet" href="../../css/main.css">
    <link rel="stylesheet" href="../../css/responsive.css">
</head>
<body>
    <div id="header-container"></div>
    <main class="chapter-container">
        <div class="chapter-header">
            <div class="chapter-number">Chapter 5</div>
            <h1 class="chapter-title">Scientific Investigation</h1>
            <p class="chapter-description">Learn the scientific method, conduct experiments, collect data, and draw conclusions like a real scientist.</p>
        </div>
        <div class="lesson-content">
            <!-- Scientific Method Lab -->
            <div class="experiment-station">
                <h3><span class="section-icon">üî¨</span>Scientific Method Laboratory</h3>
                <div class="scientific-method-container">
                    <div class="method-steps">
                        <div class="method-step" id="step-question" onclick="selectMethodStep('question')">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <div class="step-icon">‚ùì</div>
                                <h4>Ask a Question</h4>
                                <p>What do you want to find out?</p>
                            </div>
                        </div>
                        <div class="method-step" id="step-hypothesis" onclick="selectMethodStep('hypothesis')">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <div class="step-icon">üí≠</div>
                                <h4>Form a Hypothesis</h4>
                                <p>Make an educated guess about the answer.</p>
                            </div>
                        </div>
                        <div class="method-step" id="step-experiment" onclick="selectMethodStep('experiment')">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <div class="step-icon">üß™</div>
                                <h4>Design Experiment</h4>
                                <p>Plan how to test your hypothesis.</p>
                            </div>
                        </div>
                        <div class="method-step" id="step-data" onclick="selectMethodStep('data')">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <div class="step-icon">üìä</div>
                                <h4>Collect Data</h4>
                                <p>Gather information from your experiment.</p>
                            </div>
                        </div>
                        <div class="method-step" id="step-analyze" onclick="selectMethodStep('analyze')">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <div class="step-icon">üîç</div>
                                <h4>Analyze Results</h4>
                                <p>Look at your data and find patterns.</p>
                            </div>
                        </div>
                        <div class="method-step" id="step-conclusion" onclick="selectMethodStep('conclusion')">
                            <div class="step-number">6</div>
                            <div class="step-content">
                                <div class="step-icon">‚úÖ</div>
                                <h4>Draw Conclusion</h4>
                                <p>Decide if your hypothesis was correct.</p>
                            </div>
                        </div>
                    </div>
                    <div class="method-details" id="method-details">
                        <h4>Scientific Method</h4>
                        <p>Click on any step to learn more about that part of the scientific method.</p>
                    </div>
                </div>
            </div>

            <!-- Virtual Experiment Lab -->
            <div class="experiment-station">
                <h3><span class="section-icon">‚öóÔ∏è</span>Virtual Experiment Lab</h3>
                <div class="virtual-lab">
                    <div class="experiment-selector">
                        <h4>Choose an Experiment:</h4>
                        <div class="experiment-options">
                            <button onclick="startExperiment('plants')" class="experiment-btn">üå± Plant Growth</button>
                            <button onclick="startExperiment('dissolve')" class="experiment-btn">üíß Dissolving</button>
                            <button onclick="startExperiment('magnets')" class="experiment-btn">üß≤ Magnetism</button>
                            <button onclick="startExperiment('temperature')" class="experiment-btn">üå°Ô∏è Temperature</button>
                        </div>
                    </div>
                    <div class="experiment-area" id="experiment-area">
                        <div class="welcome-message">
                            <h4>Welcome to the Virtual Lab!</h4>
                            <p>Select an experiment above to begin your scientific investigation.</p>
                        </div>
                    </div>
                    <div class="experiment-data" id="experiment-data">
                        <h4>Data Collection</h4>
                        <div class="data-table" id="data-table">
                            <p>No data collected yet. Start an experiment!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Analysis Tools -->
            <div class="experiment-station">
                <h3><span class="section-icon">üìà</span>Data Analysis & Graphing Tools</h3>
                <div class="data-analysis-lab">
                    <div class="data-input-section">
                        <h4>Enter Your Data:</h4>
                        <div class="data-input-controls">
                            <div class="input-group">
                                <label>X-axis Label:</label>
                                <input type="text" id="x-axis-label" placeholder="e.g., Time (days)">
                            </div>
                            <div class="input-group">
                                <label>Y-axis Label:</label>
                                <input type="text" id="y-axis-label" placeholder="e.g., Height (cm)">
                            </div>
                            <div class="data-points">
                                <h5>Data Points:</h5>
                                <div class="data-point-inputs" id="data-point-inputs">
                                    <div class="data-point">
                                        <input type="number" class="x-value" placeholder="X value">
                                        <input type="number" class="y-value" placeholder="Y value">
                                        <button onclick="removeDataPoint(this)" class="remove-btn">√ó</button>
                                    </div>
                                </div>
                                <button onclick="addDataPoint()" class="add-data-btn">+ Add Data Point</button>
                            </div>
                        </div>
                    </div>
                    <div class="graph-section">
                        <div class="graph-controls">
                            <button onclick="createGraph()">üìä Create Graph</button>
                            <button onclick="clearGraph()">üóëÔ∏è Clear</button>
                            <select id="graph-type">
                                <option value="line">Line Graph</option>
                                <option value="bar">Bar Chart</option>
                                <option value="scatter">Scatter Plot</option>
                            </select>
                        </div>
                        <div class="graph-canvas" id="graph-canvas">
                            <div class="empty-graph">
                                <p>üìà Your graph will appear here</p>
                                <p>Enter data points and click "Create Graph"</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Observation Skills Trainer -->
            <div class="experiment-station">
                <h3><span class="section-icon">üëÅÔ∏è</span>Observation Skills Trainer</h3>
                <div class="observation-trainer">
                    <div class="observation-game">
                        <div class="observation-scene" id="observation-scene">
                            <div class="scene-container">
                                <div class="observation-objects" id="observation-objects">
                                    <!-- Objects will be dynamically added -->
                                </div>
                            </div>
                        </div>
                        <div class="observation-controls">
                            <button onclick="startObservation()">üîç Start Observation Challenge</button>
                            <button onclick="showObservationScene()">üëÄ Show Scene</button>
                            <button onclick="hideObservationScene()">üôà Hide Scene</button>
                        </div>
                        <div class="observation-questions" id="observation-questions" style="display: none;">
                            <h4>What did you observe?</h4>
                            <div class="questions-list" id="questions-list"></div>
                            <button onclick="checkObservations()" id="check-observations-btn">Check Answers</button>
                        </div>
                        <div class="observation-results" id="observation-results" style="display: none;"></div>
                    </div>
                </div>
            </div>

            <!-- Measurement Practice -->
            <div class="experiment-station">
                <h3><span class="section-icon">üìè</span>Measurement Practice Lab</h3>
                <div class="measurement-lab">
                    <div class="measurement-tools">
                        <div class="tool-section">
                            <h4>Length Measurement</h4>
                            <div class="ruler-practice">
                                <div class="measurement-object" id="length-object">üìè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</div>
                                <div class="ruler" id="ruler">
                                    <div class="ruler-marks"></div>
                                </div>
                                <div class="measurement-input">
                                    <label>Your measurement: </label>
                                    <input type="number" id="length-guess" step="0.1"> cm
                                    <button onclick="checkLengthMeasurement()">Check</button>
                                </div>
                                <div class="measurement-feedback" id="length-feedback"></div>
                            </div>
                        </div>
                        <div class="tool-section">
                            <h4>Volume Measurement</h4>
                            <div class="volume-practice">
                                <div class="measuring-cup" id="measuring-cup">
                                    <div class="cup-liquid" id="cup-liquid"></div>
                                    <div class="volume-marks">
                                        <div class="mark" data-volume="100">100ml</div>
                                        <div class="mark" data-volume="75">75ml</div>
                                        <div class="mark" data-volume="50">50ml</div>
                                        <div class="mark" data-volume="25">25ml</div>
                                    </div>
                                </div>
                                <div class="volume-controls">
                                    <button onclick="pourLiquid()">ü•§ Pour Random Amount</button>
                                    <div class="measurement-input">
                                        <label>Volume reading: </label>
                                        <input type="number" id="volume-guess"> ml
                                        <button onclick="checkVolumeMeasurement()">Check</button>
                                    </div>
                                </div>
                                <div class="measurement-feedback" id="volume-feedback"></div>
                            </div>
                        </div>
                        <div class="tool-section">
                            <h4>Temperature Reading</h4>
                            <div class="thermometer-practice">
                                <div class="thermometer" id="thermometer">
                                    <div class="thermometer-liquid" id="thermometer-liquid"></div>
                                    <div class="temperature-scale">
                                        <div class="temp-mark" data-temp="40">40¬∞C</div>
                                        <div class="temp-mark" data-temp="30">30¬∞C</div>
                                        <div class="temp-mark" data-temp="20">20¬∞C</div>
                                        <div class="temp-mark" data-temp="10">10¬∞C</div>
                                        <div class="temp-mark" data-temp="0">0¬∞C</div>
                                    </div>
                                </div>
                                <div class="temp-controls">
                                    <button onclick="setRandomTemperature()">üå°Ô∏è New Temperature</button>
                                    <div class="measurement-input">
                                        <label>Temperature reading: </label>
                                        <input type="number" id="temp-guess"> ¬∞C
                                        <button onclick="checkTemperatureMeasurement()">Check</button>
                                    </div>
                                </div>
                                <div class="measurement-feedback" id="temp-feedback"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scientific Method Quiz -->
            <div class="experiment-station quiz-station">
                <h3><span class="section-icon">üß†</span>Scientific Investigation Knowledge Challenge</h3>
                <div class="quiz-container" id="science-method-quiz">
                    <div class="quiz-question" id="science-method-quiz-question">
                        <p>What is the first step in the scientific method?</p>
                        <div class="quiz-options">
                            <button onclick="checkScienceMethodAnswer('A', true)">A) Ask a question</button>
                            <button onclick="checkScienceMethodAnswer('B', false)">B) Form a hypothesis</button>
                            <button onclick="checkScienceMethodAnswer('C', false)">C) Conduct an experiment</button>
                            <button onclick="checkScienceMethodAnswer('D', false)">D) Analyze data</button>
                        </div>
                    </div>
                    <div class="quiz-feedback" id="science-method-quiz-feedback" style="display: none;"></div>
                    <div class="quiz-progress">
                        <span>Question <span id="science-method-question-number">1</span> of <span id="science-method-total-questions">8</span></span>
                        <div class="quiz-score">Score: <span id="science-method-quiz-score">0</span>/8</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="chapter-navigation">
            <a href="chapter-4.html" class="nav-button">‚Üê Previous</a>
            <div class="progress-indicator">
                <div class="progress-text">Progress</div>
                <div class="progress-bar"><div class="progress-fill" style="width: 30%"></div></div>
            </div>
            <a href="assessment-1.html" class="nav-button">Next ‚Üí</a>
        </div>
    </main>
    <div id="footer-container"></div>
    <script src="../../js/app.js" defer></script>
    <script>
        // Load shared components
        function loadSharedComponents() {
            fetch('../shared/header.html').then(r => r.text()).then(h => document.getElementById('header-container').innerHTML = h);
            fetch('../shared/footer.html').then(r => r.text()).then(h => document.getElementById('footer-container').innerHTML = h);
        }
        document.readyState === 'loading' ? document.addEventListener('DOMContentLoaded', loadSharedComponents) : loadSharedComponents();

        // Global variables for scientific investigation activities
        let currentScienceMethodQuestion = 0;
        let scienceMethodQuizScore = 0;
        let currentExperiment = null;
        let experimentData = [];
        let observationData = {};
        let measurementScores = { length: 0, volume: 0, temperature: 0 };
        let currentMeasurements = { length: 0, volume: 0, temperature: 0 };

        // Scientific Method step data
        const methodSteps = {
            question: {
                title: "Ask a Question",
                description: "Every scientific investigation begins with curiosity. Scientists ask questions about things they observe in the world around them.",
                examples: ["Why do plants grow toward light?", "What makes ice melt faster?", "How do magnets work?"],
                tips: "Good scientific questions can be tested through experiments. They often start with 'What', 'How', 'Why', or 'Which'."
            },
            hypothesis: {
                title: "Form a Hypothesis",
                description: "A hypothesis is an educated guess that can be tested. It predicts what you think will happen and why.",
                examples: ["If I give plants more sunlight, then they will grow taller because plants need light for energy."],
                tips: "A good hypothesis uses the format: 'If... then... because...' This shows your prediction and reasoning."
            },
            experiment: {
                title: "Design an Experiment",
                description: "Plan a fair test to check your hypothesis. Control variables so you only test one thing at a time.",
                examples: ["Test two identical plants - give one more sunlight, keep everything else the same."],
                tips: "Only change one variable (independent variable). Keep everything else the same (controlled variables)."
            },
            data: {
                title: "Collect Data",
                description: "Carefully observe and record information during your experiment. Use tools to make precise measurements.",
                examples: ["Measure plant height daily, record temperature, note any changes."],
                tips: "Write down everything you observe. Use numbers when possible. Take photos or draw pictures."
            },
            analyze: {
                title: "Analyze Results",
                description: "Look for patterns in your data. Create graphs or charts to help you see trends and relationships.",
                examples: ["Make a graph showing plant growth over time. Look for patterns or trends."],
                tips: "Compare your results to your prediction. Look for patterns, trends, and unexpected results."
            },
            conclusion: {
                title: "Draw Conclusions",
                description: "Based on your data analysis, decide if your hypothesis was correct. Explain what you learned.",
                examples: ["The plant with more sunlight grew 2cm taller. My hypothesis was correct."],
                tips: "It's okay if your hypothesis was wrong! Scientists learn from unexpected results too."
            }
        };

        // Virtual experiments data
        const experiments = {
            plants: {
                name: "Plant Growth Experiment",
                question: "How does the amount of water affect plant growth?",
                hypothesis: "Plants with more water will grow taller.",
                variables: ["No water", "Little water", "Normal water", "Lots of water"],
                results: [0, 2, 8, 5], // Growth in cm after 1 week
                conclusion: "Normal water gave the best growth. Too much water can harm plants!"
            },
            dissolve: {
                name: "Dissolving Experiment",
                question: "Which substances dissolve in water?",
                hypothesis: "Salt and sugar will dissolve, but sand and oil will not.",
                variables: ["Salt", "Sugar", "Sand", "Oil"],
                results: [100, 100, 0, 0], // Percentage dissolved
                conclusion: "Salt and sugar are soluble in water. Sand and oil are insoluble."
            },
            magnets: {
                name: "Magnetism Experiment",
                question: "Which materials are attracted to magnets?",
                hypothesis: "Metal objects will be attracted to magnets.",
                variables: ["Iron nail", "Aluminum can", "Plastic spoon", "Copper penny"],
                results: [100, 0, 0, 0], // Percentage attraction
                conclusion: "Only iron is strongly magnetic. Not all metals are attracted to magnets."
            },
            temperature: {
                name: "Temperature Experiment",
                question: "How does container color affect heating in sunlight?",
                hypothesis: "Darker containers will heat up more in sunlight.",
                variables: ["Black container", "White container", "Silver container", "Clear container"],
                results: [35, 22, 18, 28], // Temperature increase in ¬∞C
                conclusion: "Black containers absorb the most heat. Light colors reflect heat better."
            }
        };

        // Quiz questions
        const scienceMethodQuestions = [
            {
                question: "What is the first step in the scientific method?",
                options: ["A) Ask a question", "B) Form a hypothesis", "C) Conduct an experiment", "D) Analyze data"],
                correct: 0,
                explanation: "The scientific method always begins with asking a question about something you observe or want to understand."
            },
            {
                question: "A hypothesis should be:",
                options: ["A) A wild guess", "B) An educated guess that can be tested", "C) Always correct", "D) The final answer"],
                correct: 1,
                explanation: "A hypothesis is an educated guess based on prior knowledge that can be tested through experimentation."
            },
            {
                question: "In a controlled experiment, you should:",
                options: ["A) Change all variables", "B) Change no variables", "C) Change only one variable at a time", "D) Guess the results"],
                correct: 2,
                explanation: "To have a fair test, you should only change one variable (independent variable) while keeping others constant."
            },
            {
                question: "What should you do if your hypothesis is proven wrong?",
                options: ["A) Hide the results", "B) Change the data", "C) Learn from it and form a new hypothesis", "D) Give up"],
                correct: 2,
                explanation: "Wrong hypotheses are valuable! They help scientists learn and develop better explanations."
            },
            {
                question: "The best way to collect data is to:",
                options: ["A) Estimate everything", "B) Use precise measurements and tools", "C) Just remember what happened", "D) Ask friends what they think"],
                correct: 1,
                explanation: "Accurate data collection requires precise measurements using appropriate scientific tools."
            },
            {
                question: "A variable that you measure in an experiment is called:",
                options: ["A) Independent variable", "B) Dependent variable", "C) Controlled variable", "D) Random variable"],
                correct: 1,
                explanation: "The dependent variable is what you measure or observe as a result of changing the independent variable."
            },
            {
                question: "Why do scientists repeat experiments?",
                options: ["A) They forgot the results", "B) To make sure results are reliable", "C) It's more fun", "D) They have extra time"],
                correct: 1,
                explanation: "Repeating experiments helps ensure results are reliable and not due to chance or errors."
            },
            {
                question: "What makes a good scientific observation?",
                options: ["A) It includes personal opinions", "B) It's based on facts you can measure", "C) It's what you expected to see", "D) It's always the same"],
                correct: 1,
                explanation: "Good scientific observations are objective, measurable, and based on what actually happened, not opinions."
            }
        ];

        // Initialize all systems when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeScientificMethod();
            initializeVirtualLab();
            initializeDataAnalysis();
            initializeMeasurementLab();
            initializeScienceMethodQuiz();
            generateRuler();
        });

        // Scientific Method Functions
        function initializeScientificMethod() {
            selectMethodStep('question');
        }

        function selectMethodStep(stepName) {
            const step = methodSteps[stepName];
            if (!step) return;

            // Update visual selection
            document.querySelectorAll('.method-step').forEach(el => el.classList.remove('selected'));
            document.getElementById(`step-${stepName}`).classList.add('selected');

            // Update details
            document.getElementById('method-details').innerHTML = `
                <h4>${step.title}</h4>
                <p><strong>What it means:</strong> ${step.description}</p>
                <p><strong>Examples:</strong></p>
                <ul>
                    ${step.examples.map(example => `<li>${example}</li>`).join('')}
                </ul>
                <p><strong>Tips:</strong> ${step.tips}</p>
            `;
        }

        // Virtual Experiment Functions
        function initializeVirtualLab() {
            // Lab is ready
        }

        function startExperiment(experimentType) {
            currentExperiment = experiments[experimentType];
            const experimentArea = document.getElementById('experiment-area');
            
            experimentArea.innerHTML = `
                <div class="active-experiment">
                    <h4>${currentExperiment.name}</h4>
                    <div class="experiment-info">
                        <p><strong>Question:</strong> ${currentExperiment.question}</p>
                        <p><strong>Hypothesis:</strong> ${currentExperiment.hypothesis}</p>
                    </div>
                    <div class="experiment-simulation">
                        <h5>Experiment Results:</h5>
                        <div class="experiment-results">
                            ${currentExperiment.variables.map((variable, index) => `
                                <div class="result-item">
                                    <div class="variable-name">${variable}</div>
                                    <div class="result-bar">
                                        <div class="result-fill" style="width: ${currentExperiment.results[index]}%"></div>
                                    </div>
                                    <div class="result-value">${currentExperiment.results[index]}${experimentType === 'temperature' ? '¬∞C' : experimentType === 'dissolve' || experimentType === 'magnets' ? '%' : 'cm'}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div class="experiment-conclusion">
                        <p><strong>Conclusion:</strong> ${currentExperiment.conclusion}</p>
                    </div>
                    <button onclick="recordExperimentData()">üìù Record Data</button>
                </div>
            `;
        }

        function recordExperimentData() {
            if (!currentExperiment) return;
            
            experimentData.push({
                name: currentExperiment.name,
                question: currentExperiment.question,
                results: currentExperiment.results,
                variables: currentExperiment.variables,
                timestamp: new Date().toLocaleString()
            });
            
            updateDataTable();
            alert('‚úÖ Experiment data recorded successfully!');
        }

        function updateDataTable() {
            const dataTable = document.getElementById('data-table');
            if (experimentData.length === 0) {
                dataTable.innerHTML = '<p>No data collected yet. Start an experiment!</p>';
                return;
            }
            
            let tableHTML = '<table><tr><th>Experiment</th><th>Variables Tested</th><th>Results</th><th>Time</th></tr>';
            experimentData.forEach(exp => {
                tableHTML += `
                    <tr>
                        <td>${exp.name}</td>
                        <td>${exp.variables.join(', ')}</td>
                        <td>${exp.results.join(', ')}</td>
                        <td>${exp.timestamp}</td>
                    </tr>
                `;
            });
            tableHTML += '</table>';
            dataTable.innerHTML = tableHTML;
        }

        // Data Analysis Functions
        function initializeDataAnalysis() {
            // Add initial data point
            // Already has one from HTML
        }

        function addDataPoint() {
            const container = document.getElementById('data-point-inputs');
            const newPoint = document.createElement('div');
            newPoint.className = 'data-point';
            newPoint.innerHTML = `
                <input type="number" class="x-value" placeholder="X value">
                <input type="number" class="y-value" placeholder="Y value">
                <button onclick="removeDataPoint(this)" class="remove-btn">√ó</button>
            `;
            container.appendChild(newPoint);
        }

        function removeDataPoint(button) {
            const container = document.getElementById('data-point-inputs');
            if (container.children.length > 1) {
                button.parentElement.remove();
            }
        }

        function createGraph() {
            const xLabel = document.getElementById('x-axis-label').value || 'X Values';
            const yLabel = document.getElementById('y-axis-label').value || 'Y Values';
            const graphType = document.getElementById('graph-type').value;
            
            // Collect data points
            const dataPoints = [];
            const pointInputs = document.querySelectorAll('.data-point');
            pointInputs.forEach(point => {
                const x = parseFloat(point.querySelector('.x-value').value);
                const y = parseFloat(point.querySelector('.y-value').value);
                if (!isNaN(x) && !isNaN(y)) {
                    dataPoints.push({ x, y });
                }
            });
            
            if (dataPoints.length === 0) {
                alert('Please enter some data points first!');
                return;
            }
            
            // Create simple text-based graph
            const canvas = document.getElementById('graph-canvas');
            let graphHTML = `
                <div class="graph-header">
                    <h4>${graphType.charAt(0).toUpperCase() + graphType.slice(1)} Graph</h4>
                </div>
                <div class="graph-content">
                    <div class="y-axis-label">${yLabel}</div>
                    <div class="graph-area">
                        <div class="data-visualization">
            `;
            
            // Simple bar chart representation
            if (graphType === 'bar') {
                const maxY = Math.max(...dataPoints.map(p => p.y));
                dataPoints.forEach(point => {
                    const height = (point.y / maxY) * 100;
                    graphHTML += `
                        <div class="bar-item">
                            <div class="bar" style="height: ${height}%"></div>
                            <div class="bar-label">${point.x}</div>
                        </div>
                    `;
                });
            } else {
                // Line/scatter plot representation
                dataPoints.forEach((point, index) => {
                    graphHTML += `
                        <div class="data-point-visual" style="left: ${(index / (dataPoints.length - 1)) * 100}%; bottom: ${(point.y / Math.max(...dataPoints.map(p => p.y))) * 100}%">
                            <div class="point">‚óè</div>
                            <div class="point-label">(${point.x}, ${point.y})</div>
                        </div>
                    `;
                });
            }
            
            graphHTML += `
                        </div>
                    </div>
                    <div class="x-axis-label">${xLabel}</div>
                </div>
            `;
            
            canvas.innerHTML = graphHTML;
        }

        function clearGraph() {
            document.getElementById('graph-canvas').innerHTML = `
                <div class="empty-graph">
                    <p>üìà Your graph will appear here</p>
                    <p>Enter data points and click "Create Graph"</p>
                </div>
            `;
            
            // Clear inputs
            document.getElementById('x-axis-label').value = '';
            document.getElementById('y-axis-label').value = '';
            document.querySelectorAll('.x-value').forEach(input => input.value = '');
            document.querySelectorAll('.y-value').forEach(input => input.value = '');
        }

        // Observation Functions
        function startObservation() {
            // Generate random scene
            const objects = ['üå≥', 'üè†', 'üöó', 'üêï', 'ü¶Ö', '‚òÄÔ∏è', '‚òÅÔ∏è', 'üå∏'];
            const colors = ['red', 'blue', 'green', 'yellow', 'purple'];
            
            const selectedObjects = [];
            for (let i = 0; i < 5; i++) {
                selectedObjects.push({
                    object: objects[Math.floor(Math.random() * objects.length)],
                    position: { x: Math.random() * 80 + 10, y: Math.random() * 80 + 10 }
                });
            }
            
            observationData = {
                objects: selectedObjects,
                questions: [
                    { question: 'How many objects did you see?', answer: selectedObjects.length },
                    { question: 'What was in the top-left area?', answer: 'varies' },
                    { question: 'How many trees were there?', answer: selectedObjects.filter(o => o.object === 'üå≥').length }
                ]
            };
            
            showObservationScene();
        }

        function showObservationScene() {
            if (!observationData.objects) {
                alert('Please start an observation challenge first!');
                return;
            }
            
            const container = document.getElementById('observation-objects');
            container.innerHTML = '';
            
            observationData.objects.forEach(obj => {
                const div = document.createElement('div');
                div.className = 'observation-object';
                div.style.left = obj.position.x + '%';
                div.style.top = obj.position.y + '%';
                div.textContent = obj.object;
                container.appendChild(div);
            });
            
            setTimeout(() => {
                document.getElementById('observation-questions').style.display = 'block';
                loadObservationQuestions();
            }, 5000);
        }

        function hideObservationScene() {
            document.getElementById('observation-objects').innerHTML = '';
        }

        function loadObservationQuestions() {
            const questionsList = document.getElementById('questions-list');
            questionsList.innerHTML = observationData.questions.map((q, index) => `
                <div class="observation-question">
                    <p>${q.question}</p>
                    <input type="text" id="obs-answer-${index}" placeholder="Your answer">
                </div>
            `).join('');
        }

        function checkObservations() {
            let correct = 0;
            const results = document.getElementById('observation-results');
            let resultsHTML = '<h4>Observation Results:</h4>';
            
            observationData.questions.forEach((q, index) => {
                const userAnswer = document.getElementById(`obs-answer-${index}`).value;
                const isCorrect = userAnswer == q.answer || (q.answer === 'varies');
                
                if (isCorrect) correct++;
                
                resultsHTML += `
                    <div class="obs-result ${isCorrect ? 'correct' : 'incorrect'}">
                        <p><strong>Q:</strong> ${q.question}</p>
                        <p><strong>Your answer:</strong> ${userAnswer}</p>
                        <p><strong>Status:</strong> ${isCorrect ? '‚úÖ Correct' : '‚ùå Incorrect'}</p>
                    </div>
                `;
            });
            
            resultsHTML += `<p><strong>Score: ${correct}/${observationData.questions.length}</strong></p>`;
            results.innerHTML = resultsHTML;
            results.style.display = 'block';
        }

        // Measurement Functions
        function initializeMeasurementLab() {
            setRandomLength();
            setRandomTemperature();
            pourLiquid();
        }

        function generateRuler() {
            const rulerMarks = document.querySelector('.ruler-marks');
            let marksHTML = '';
            for (let i = 0; i <= 20; i++) {
                marksHTML += `<div class="mark" style="left: ${i * 5}%">${i}</div>`;
            }
            rulerMarks.innerHTML = marksHTML;
        }

        function setRandomLength() {
            currentMeasurements.length = Math.random() * 15 + 5; // 5-20 cm
            const lengthObject = document.getElementById('length-object');
            const width = (currentMeasurements.length / 20) * 100; // Scale to ruler
            lengthObject.style.width = width + '%';
        }

        function checkLengthMeasurement() {
            const guess = parseFloat(document.getElementById('length-guess').value);
            const actual = currentMeasurements.length;
            const diff = Math.abs(guess - actual);
            const feedback = document.getElementById('length-feedback');
            
            if (diff <= 0.5) {
                feedback.innerHTML = `<div class="correct">‚úÖ Excellent! Actual: ${actual.toFixed(1)}cm</div>`;
                measurementScores.length++;
            } else if (diff <= 1.5) {
                feedback.innerHTML = `<div class="close">üî∂ Close! Actual: ${actual.toFixed(1)}cm</div>`;
            } else {
                feedback.innerHTML = `<div class="incorrect">‚ùå Try again! Actual: ${actual.toFixed(1)}cm</div>`;
            }
            
            setTimeout(setRandomLength, 2000);
        }

        function pourLiquid() {
            currentMeasurements.volume = Math.random() * 90 + 10; // 10-100 ml
            const liquid = document.getElementById('cup-liquid');
            liquid.style.height = currentMeasurements.volume + '%';
        }

        function checkVolumeMeasurement() {
            const guess = parseFloat(document.getElementById('volume-guess').value);
            const actual = currentMeasurements.volume;
            const diff = Math.abs(guess - actual);
            const feedback = document.getElementById('volume-feedback');
            
            if (diff <= 5) {
                feedback.innerHTML = `<div class="correct">‚úÖ Excellent! Actual: ${actual.toFixed(0)}ml</div>`;
                measurementScores.volume++;
            } else if (diff <= 10) {
                feedback.innerHTML = `<div class="close">üî∂ Close! Actual: ${actual.toFixed(0)}ml</div>`;
            } else {
                feedback.innerHTML = `<div class="incorrect">‚ùå Try again! Actual: ${actual.toFixed(0)}ml</div>`;
            }
            
            setTimeout(pourLiquid, 2000);
        }

        function setRandomTemperature() {
            currentMeasurements.temperature = Math.random() * 35 + 5; // 5-40¬∞C
            const liquid = document.getElementById('thermometer-liquid');
            liquid.style.height = (currentMeasurements.temperature / 40) * 100 + '%';
        }

        function checkTemperatureMeasurement() {
            const guess = parseFloat(document.getElementById('temp-guess').value);
            const actual = currentMeasurements.temperature;
            const diff = Math.abs(guess - actual);
            const feedback = document.getElementById('temp-feedback');
            
            if (diff <= 2) {
                feedback.innerHTML = `<div class="correct">‚úÖ Excellent! Actual: ${actual.toFixed(0)}¬∞C</div>`;
                measurementScores.temperature++;
            } else if (diff <= 5) {
                feedback.innerHTML = `<div class="close">üî∂ Close! Actual: ${actual.toFixed(0)}¬∞C</div>`;
            } else {
                feedback.innerHTML = `<div class="incorrect">‚ùå Try again! Actual: ${actual.toFixed(0)}¬∞C</div>`;
            }
            
            setTimeout(setRandomTemperature, 2000);
        }

        // Quiz Functions
        function initializeScienceMethodQuiz() {
            loadScienceMethodQuestion();
        }

        function loadScienceMethodQuestion() {
            if (currentScienceMethodQuestion >= scienceMethodQuestions.length) {
                showScienceMethodResults();
                return;
            }
            
            const question = scienceMethodQuestions[currentScienceMethodQuestion];
            document.getElementById('science-method-quiz-question').innerHTML = `
                <p>${question.question}</p>
                <div class="quiz-options">
                    ${question.options.map((option, index) => 
                        `<button onclick="checkScienceMethodAnswer(${index}, ${index === question.correct})">${option}</button>`
                    ).join('')}
                </div>
            `;
            
            document.getElementById('science-method-question-number').textContent = currentScienceMethodQuestion + 1;
            document.getElementById('science-method-quiz-feedback').style.display = 'none';
        }

        function checkScienceMethodAnswer(selectedIndex, isCorrect) {
            const question = scienceMethodQuestions[currentScienceMethodQuestion];
            const feedback = document.getElementById('science-method-quiz-feedback');
            
            if (isCorrect) {
                scienceMethodQuizScore++;
                feedback.innerHTML = `<div class="correct">‚úÖ Correct! ${question.explanation}</div>`;
            } else {
                feedback.innerHTML = `<div class="incorrect">‚ùå Incorrect. ${question.explanation}</div>`;
            }
            
            feedback.style.display = 'block';
            document.getElementById('science-method-quiz-score').textContent = scienceMethodQuizScore;
            
            // Disable buttons
            document.querySelectorAll('#science-method-quiz-question .quiz-options button').forEach(btn => btn.disabled = true);
            
            // Auto-advance after 3 seconds
            setTimeout(() => {
                currentScienceMethodQuestion++;
                loadScienceMethodQuestion();
            }, 3000);
        }

        function showScienceMethodResults() {
            const percentage = Math.round((scienceMethodQuizScore / scienceMethodQuestions.length) * 100);
            const resultMessage = percentage >= 80 ? 
                "üî¨ Outstanding! You're ready to be a scientist!" :
                percentage >= 60 ? 
                "üìä Good work! You understand the scientific method well!" :
                "üìñ Keep practicing! Try the virtual experiments to learn more.";
            
            document.getElementById('science-method-quiz-question').innerHTML = `
                <div class="quiz-complete">
                    <h3>Quiz Complete!</h3>
                    <p>Your Score: ${scienceMethodQuizScore}/${scienceMethodQuestions.length} (${percentage}%)</p>
                    <p>${resultMessage}</p>
                    <button onclick="restartScienceMethodQuiz()">Take Quiz Again</button>
                </div>
            `;
        }

        function restartScienceMethodQuiz() {
            currentScienceMethodQuestion = 0;
            scienceMethodQuizScore = 0;
            document.getElementById('science-method-quiz-score').textContent = '0';
            loadScienceMethodQuestion();
        }
    </script>
    
    <style>
        /* Scientific Investigation Interactive Styles */
        .experiment-station {
            background: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid #2196f3;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.1);
        }

        /* Scientific Method Styles */
        .scientific-method-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .method-steps {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .method-step {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            border: 3px solid #ddd;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .method-step:hover {
            border-color: #2196f3;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.2);
        }

        .method-step.selected {
            border-color: #2196f3;
            background: #e3f2fd;
        }

        .step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #2196f3;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .step-content h4 {
            margin: 0 0 5px 0;
            color: #333;
        }

        .step-content p {
            margin: 0;
            color: #666;
            font-size: 0.9rem;
        }

        .method-details {
            background: white;
            border-radius: 10px;
            padding: 20px;
            height: fit-content;
        }

        .method-details ul {
            padding-left: 20px;
            margin: 10px 0;
        }

        .method-details li {
            margin: 5px 0;
            color: #555;
        }

        /* Virtual Lab Styles */
        .virtual-lab {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .experiment-selector {
            margin-bottom: 20px;
        }

        .experiment-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .experiment-btn {
            padding: 15px;
            border: 2px solid #2196f3;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .experiment-btn:hover {
            background: #e3f2fd;
            transform: translateY(-2px);
        }

        .experiment-area {
            min-height: 200px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .welcome-message {
            text-align: center;
            color: #666;
        }

        .active-experiment {
            animation: fadeIn 0.5s ease;
        }

        .experiment-results {
            display: grid;
            gap: 10px;
            margin: 15px 0;
        }

        .result-item {
            display: grid;
            grid-template-columns: 1fr 2fr auto;
            gap: 10px;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
        }

        .result-bar {
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .result-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #2196f3);
            border-radius: 10px;
            transition: width 1s ease;
        }

        .experiment-data {
            background: #f0f8ff;
            border-radius: 10px;
            padding: 20px;
        }

        .experiment-data table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .experiment-data th,
        .experiment-data td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .experiment-data th {
            background: #2196f3;
            color: white;
        }

        /* Data Analysis Styles */
        .data-analysis-lab {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .data-input-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .input-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .data-points {
            margin-top: 15px;
        }

        .data-point {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .data-point input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .remove-btn {
            background: #f44336;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
        }

        .add-data-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        .graph-section {
            display: flex;
            flex-direction: column;
        }

        .graph-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .graph-controls button {
            padding: 8px 15px;
            border: 1px solid #2196f3;
            background: white;
            border-radius: 5px;
            cursor: pointer;
        }

        .graph-controls button:hover {
            background: #e3f2fd;
        }

        .graph-canvas {
            flex: 1;
            border: 2px solid #ddd;
            border-radius: 8px;
            min-height: 300px;
            background: white;
            position: relative;
        }

        .empty-graph {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #666;
        }

        .graph-content {
            padding: 20px;
            height: 100%;
            display: grid;
            grid-template-rows: auto 1fr auto;
        }

        .graph-area {
            position: relative;
            border: 1px solid #ddd;
            margin: 10px 0;
        }

        .data-visualization {
            display: flex;
            align-items: end;
            height: 200px;
            padding: 10px;
        }

        .bar-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 5px;
        }

        .bar {
            width: 30px;
            background: #2196f3;
            margin-bottom: 5px;
            border-radius: 3px 3px 0 0;
        }

        .bar-label {
            font-size: 12px;
            color: #666;
        }

        /* Observation Trainer Styles */
        .observation-trainer {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .observation-scene {
            height: 300px;
            background: linear-gradient(to bottom, #87ceeb 0%, #90EE90 50%, #8b4513 100%);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            margin: 15px 0;
        }

        .scene-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .observation-objects {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .observation-object {
            position: absolute;
            font-size: 2rem;
            animation: fadeIn 0.5s ease;
        }

        .observation-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .observation-questions {
            background: #f0f8ff;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .observation-question {
            margin-bottom: 15px;
        }

        .observation-question input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 5px;
        }

        .observation-results {
            margin-top: 15px;
        }

        .obs-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
        }

        .obs-result.correct {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
        }

        .obs-result.incorrect {
            background: #ffebee;
            border-left: 4px solid #f44336;
        }

        /* Measurement Lab Styles */
        .measurement-lab {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .measurement-tools {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .tool-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
        }

        .ruler-practice {
            margin-top: 15px;
        }

        .measurement-object {
            font-family: monospace;
            font-size: 14px;
            margin-bottom: 10px;
            height: 20px;
            background: #ff9800;
            border-radius: 3px;
            display: flex;
            align-items: center;
            padding: 0 5px;
            color: white;
            width: 60%;
            transition: width 0.5s ease;
        }

        .ruler {
            position: relative;
            height: 30px;
            background: #f0e68c;
            border: 2px solid #333;
            border-radius: 3px;
            margin: 10px 0;
        }

        .ruler-marks {
            display: flex;
            justify-content: space-between;
            height: 100%;
            align-items: end;
            padding: 0 5px;
        }

        .ruler-marks .mark {
            font-size: 10px;
            color: #333;
        }

        .measuring-cup {
            width: 80px;
            height: 150px;
            border: 3px solid #333;
            border-radius: 0 0 10px 10px;
            position: relative;
            background: rgba(255,255,255,0.8);
            margin: 0 auto;
        }

        .cup-liquid {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: linear-gradient(to top, #4fc3f7, #81c784);
            border-radius: 0 0 7px 7px;
            transition: height 0.5s ease;
        }

        .volume-marks {
            position: absolute;
            right: -40px;
            top: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .volume-marks .mark {
            font-size: 10px;
            color: #333;
        }

        .thermometer {
            width: 30px;
            height: 200px;
            background: rgba(255,255,255,0.8);
            border: 3px solid #333;
            border-radius: 15px;
            position: relative;
            margin: 0 auto;
        }

        .thermometer-liquid {
            position: absolute;
            bottom: 5px;
            left: 5px;
            right: 5px;
            background: linear-gradient(to top, #f44336, #ff9800);
            border-radius: 0 0 10px 10px;
            transition: height 0.5s ease;
        }

        .temperature-scale {
            position: absolute;
            left: -40px;
            top: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .temp-mark {
            font-size: 10px;
            color: #333;
        }

        .measurement-input {
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .measurement-input input {
            width: 80px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }

        .measurement-feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            min-height: 20px;
        }

        .measurement-feedback .correct {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .measurement-feedback .close {
            background: #fff3e0;
            color: #f57c00;
        }

        .measurement-feedback .incorrect {
            background: #ffebee;
            color: #c62828;
        }

        /* Quiz Styles */
        .quiz-station {
            border-color: #673ab7;
            background: linear-gradient(135deg, #f8f9fa 0%, #f3e5f5 100%);
        }

        /* Animation Keyframes */
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .scientific-method-container {
                grid-template-columns: 1fr;
            }
            
            .method-steps {
                grid-template-columns: 1fr;
            }
            
            .data-analysis-lab {
                grid-template-columns: 1fr;
            }
            
            .measurement-tools {
                grid-template-columns: 1fr;
            }
            
            .experiment-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</body>
</html>
